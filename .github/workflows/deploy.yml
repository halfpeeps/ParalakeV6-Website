name: Deploy to GitHub Pages

on:
  push:
    branches:
      - release  # Trigger this workflow on push to the 'release' branch
      
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      # Step 1: Checkout the private repository's release branch
      - name: Checkout the private repo's release branch
        uses: actions/checkout@v3
        with:
          repository: halfpeeps/Paralake-V6-Development-Archive  # Change to your username/repo
          ref: release  # The branch in the private repo to watch (release)
          token: ${{ secrets.GITHUB_TOKEN }}  # GitHub token for authentication

      # Step 2: Set up Git and configure user details for committing to the public repo
      - name: Set up Git
        run: |
          git config --global user.name "Your Name"  # Replace with your name
          git config --global user.email "your-email@example.com"  # Replace with your email

      # Step 3: Clone the public GitHub Pages repository (PHV6-Development-Archive)
      - name: Clone the public repository
        run: |
          git clone https://github.com/halfpeeps/PHV6-Development-Archive.git
          cd PHV6-Development-Archive

      # Step 4: Copy content from the private repo's release branch to the public repo
      - name: Copy website files
        run: |
          cd ..
          rsync -av --exclude='.git' Paralake-V6-Development-Archive/release/ PHV6-Development-Archive/
          cd PHV6-Development-Archive

      # Step 5: Commit and push changes to the public repo
      - name: Commit and push changes to the public repo
        run: |
          git add .
          git commit -m "Update GitHub Pages from release branch"
          git push origin main  # or 'master', depending on your default branch in the public repo